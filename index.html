<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KYB </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        :root {
            --emerald-50: #ecfdf5;
            --emerald-100: #d1fae5;
            --emerald-200: #a7f3d0;
            --emerald-300: #6ee7b7;
            --emerald-400: #34d399;
            --emerald-500: #10b981;
            --emerald-600: #059669;
            --emerald-700: #047857;
            --emerald-800: #065f46;
            --emerald-900: #064e3b;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 100%);
        }
        
        .emerald-gradient {
            background: linear-gradient(135deg, var(--emerald-600), var(--emerald-400));
        }
        
        .emerald-gradient-hover:hover {
            background: linear-gradient(135deg, var(--emerald-700), var(--emerald-500));
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .poster-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .poster-card:hover {
            transform: scale(1.08) translateY(-8px);
            box-shadow: 0 25px 50px rgba(16, 185, 129, 0.3);
        }
        
        .poster-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(16, 185, 129, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .poster-card:hover::before {
            opacity: 1;
        }
        
        .banner-slide {
            background-size: cover;
            background-position: center;
            position: relative;
        }
        
        .banner-slide::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, rgba(0,0,0,0.8), rgba(0,0,0,0.3));
        }
        
        .banner-content {
            position: relative;
            z-index: 10;
        }
        
        .section-title {
            position: relative;
            display: inline-block;
            font-weight: 700;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, var(--emerald-500), var(--emerald-300));
            border-radius: 2px;
        }
        
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -4px;
            left: 50%;
            width: 0;
            height: 2px;
            background: var(--emerald-500);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        .continue-watching-card {
            position: relative;
            overflow: hidden;
        }
        
        .progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 4px;
            background: var(--emerald-500);
            transition: width 0.3s ease;
        }
        
        .floating-action {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }
        
        .notification {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .carousel-container {
            scroll-behavior: smooth;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .carousel-container::-webkit-scrollbar {
            display: none;
        }
        
        .login-modal {
            backdrop-filter: blur(20px);
            background: rgba(0, 0, 0, 0.8);
        }
        
        .modal-content {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        @keyframes shimmer {
            0% { background-position: -200px 0; }
            100% { background-position: calc(200px + 100%) 0; }
        }
        
        .loading-shimmer {
            background: linear-gradient(90deg, #374151 25%, #4b5563 37%, #374151 63%);
            background-size: 400px 100%;
            animation: shimmer 1.5s ease-in-out infinite;
        }
        
        .rating-stars {
            color: #fbbf24;
        }
        
        .genre-tag {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: var(--emerald-300);
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">
    <!-- Header Premium -->
    <header class="glass-effect sticky top-0 z-50 border-b border-emerald-500/20">
        <div class="container mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <!-- Logo Premium -->
                <div class="flex items-center space-x-4">
                    <div class="text-3xl font-bold emerald-gradient bg-clip-text text-transparent">
                        KYB
                    </div>
                </div>
                
                <!-- Navigation Premium -->
                <nav class="hidden lg:flex items-center space-x-8">
                    <a href="#" class="nav-link text-white hover:text-emerald-400 font-medium">Inicio</a>
                    <a href="#" class="nav-link text-white hover:text-emerald-400 font-medium">Películas</a>
                    <a href="#" class="nav-link text-white hover:text-emerald-400 font-medium">Series</a>
                    <a href="#" class="nav-link text-white hover:text-emerald-400 font-medium">Animes</a>
                    <a href="#" class="nav-link text-white hover:text-emerald-400 font-medium">K-Dramas</a>
                    <a href="#" class="nav-link text-white hover:text-emerald-400 font-medium">Mi Lista</a>
                </nav>
                
                <!-- Search & User Actions -->
                <div class="flex items-center space-x-4">
                    <!-- Search Icon -->
                    <button id="searchBtn" class="glass-effect p-3 rounded-xl hover:bg-white/10 transition-all">
                        <svg class="w-6 h-6 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                    </button>
                    
                    <!-- User Profile -->
                    <div id="userSection" class="flex items-center space-x-3">
                        <!-- Login Button (shown when not logged in) -->
                        <button id="loginBtn" class="emerald-gradient emerald-gradient-hover px-6 py-2 rounded-xl font-semibold transition-all transform hover:scale-105">
                            Iniciar Sesión
                        </button>
                        
                        <!-- User Profile (shown when logged in) -->
                        <div id="userProfile" class="hidden flex items-center space-x-3">
                            <div class="relative">
                                <button id="notificationBtn" class="relative p-2 text-emerald-400 hover:text-emerald-300 transition-colors">
                                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-5 5v-5z"></path>
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"></path>
                                    </svg>
                                    <span id="notificationBadge" class="absolute -top-1 -right-1 bg-red-500 text-xs rounded-full h-5 w-5 flex items-center justify-center hidden">3</span>
                                </button>
                            </div>
                            <div class="relative">
                                <div class="flex items-center space-x-2 cursor-pointer" id="profileDropdown">
                                    <img id="userAvatar" src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle fill='%2310b981' cx='50' cy='50' r='50'/><text x='50' y='60' text-anchor='middle' fill='white' font-size='40' font-family='Arial'>U</text></svg>" 
                                         alt="Avatar" class="w-10 h-10 rounded-full border-2 border-emerald-500">
                                    <span id="userName" class="text-white font-medium">Usuario</span>
                                    <svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                                <!-- Dropdown Menu -->
                                <div id="profileMenu" class="absolute right-0 top-full mt-2 w-48 glass-effect rounded-xl border border-emerald-500/20 hidden">
                                    <div class="py-2">
                                        <a href="#" class="block px-4 py-2 text-white hover:bg-white/10 transition-colors">Mi Perfil</a>
                                        <a href="#" class="block px-4 py-2 text-white hover:bg-white/10 transition-colors">Configuración</a>
                                        <hr class="border-emerald-500/20 my-2">
                                        <button id="logoutBtn" class="block w-full text-left px-4 py-2 text-red-400 hover:bg-white/10 transition-colors">Cerrar Sesión</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Hero Banner Premium -->
    <section class="relative h-[70vh] overflow-hidden">
        <div id="heroBanner" class="flex transition-transform duration-700 ease-in-out h-full">
            <!-- Hero Slide 1 -->
            <div class="banner-slide min-w-full h-full flex items-center" style="background-image: url('data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 1200 600%22><defs><linearGradient id=%22grad1%22 x1=%220%25%22 y1=%220%25%22 x2=%22100%25%22 y2=%22100%25%22><stop offset=%220%25%22 style=%22stop-color:%23064e3b;stop-opacity:1%22 /><stop offset=%22100%25%22 style=%22stop-color:%2310b981;stop-opacity:1%22 /></linearGradient></defs><rect width=%221200%22 height=%22600%22 fill=%22url(%23grad1)%22/><rect x=%22100%22 y=%22150%22 width=%22800%22 height=%22300%22 rx=%2220%22 fill=%22rgba(255,255,255,0.1)%22/><text x=%22500%22 y=%22320%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2248%22 font-family=%22Arial%22 font-weight=%22bold%22>PELÍCULA ÉPICA 2024</text></svg>')">
                <div class="banner-content container mx-auto px-6">
                    <div class="max-w-3xl">
                        <div class="flex items-center space-x-2 mb-4">
                            <span class="genre-tag px-3 py-1 rounded-full text-sm font-medium">Acción</span>
                            <span class="genre-tag px-3 py-1 rounded-full text-sm font-medium">Aventura</span>
                            <div class="flex items-center space-x-1">
                                <div class="rating-stars flex">
                                    ★★★★★
                                </div>
                                <span class="text-emerald-300 text-sm font-medium">9.2</span>
                            </div>
                        </div>
                        <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                            <span class="emerald-gradient bg-clip-text text-transparent">Guardians</span>
                            <br>of Tomorrow
                        </h1>
                        <p class="text-xl md:text-2xl mb-8 text-gray-300 leading-relaxed">
                            Una épica aventura que definirá el destino de la humanidad. Efectos visuales revolucionarios y una historia que te mantendrá al borde del asiento.
                        </p>
                        <div class="flex flex-wrap items-center space-x-4 space-y-2">
                            <button onclick="playContent('guardians-tomorrow')" class="emerald-gradient emerald-gradient-hover px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105 flex items-center space-x-2">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8 5v14l11-7z"/>
                                </svg>
                                <span>Ver Ahora</span>
                            </button>
                            <button onclick="addToMyListFromHero('guardians-tomorrow')" class="glass-effect px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105 flex items-center space-x-2 hover:bg-white/10">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                <span>Mi Lista</span>
                            </button>
                            <button onclick="showMoreInfo('guardians-tomorrow')" class="glass-effect px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105 flex items-center space-x-2 hover:bg-white/10">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <span>Más Info</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Hero Slide 2 -->
            <div class="banner-slide min-w-full h-full flex items-center" style="background-image: url('data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 1200 600%22><defs><linearGradient id=%22grad2%22 x1=%220%25%22 y1=%220%25%22 x2=%22100%25%22 y2=%22100%25%22><stop offset=%220%25%22 style=%22stop-color:%23991b1b;stop-opacity:1%22 /><stop offset=%22100%25%22 style=%22stop-color:%23dc2626;stop-opacity:1%22 /></linearGradient></defs><rect width=%221200%22 height=%22600%22 fill=%22url(%23grad2)%22/><rect x=%22100%22 y=%22150%22 width=%22800%22 height=%22300%22 rx=%2220%22 fill=%22rgba(255,255,255,0.1)%22/><text x=%22500%22 y=%22320%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2248%22 font-family=%22Arial%22 font-weight=%22bold%22>ANIME LEGENDARIO</text></svg>')">
                <div class="banner-content container mx-auto px-6">
                    <div class="max-w-3xl">
                        <div class="flex items-center space-x-2 mb-4">
                            <span class="genre-tag px-3 py-1 rounded-full text-sm font-medium">Anime</span>
                            <span class="genre-tag px-3 py-1 rounded-full text-sm font-medium">Shonen</span>
                            <div class="flex items-center space-x-1">
                                <div class="rating-stars flex">
                                    ★★★★★
                                </div>
                                <span class="text-emerald-300 text-sm font-medium">9.8</span>
                            </div>
                        </div>
                        <h1 class="text-5xl md:text-7xl font-bold mb-6 leading-tight">
                            <span class="emerald-gradient bg-clip-text text-transparent">Dragon</span>
                            <br>Legends
                        </h1>
                        <p class="text-xl md:text-2xl mb-8 text-gray-300 leading-relaxed">
                            La serie anime más esperada del año. Una historia épica de amistad, poder y destino que marcará una nueva era en el anime.
                        </p>
                        <div class="flex flex-wrap items-center space-x-4 space-y-2">
                            <button onclick="playContent('dragon-legends')" class="emerald-gradient emerald-gradient-hover px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105 flex items-center space-x-2">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M8 5v14l11-7z"/>
                                </svg>
                                <span>Ver Ahora</span>
                            </button>
                            <button onclick="addToMyListFromHero('dragon-legends')" class="glass-effect px-8 py-4 rounded-xl font-bold text-lg transition-all transform hover:scale-105 flex items-center space-x-2 hover:bg-white/10">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                                <span>Mi Lista</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Hero Navigation -->
        <button id="heroPrev" class="absolute left-6 top-1/2 transform -translate-y-1/2 glass-effect p-3 rounded-full hover:bg-white/20 transition-all">
            <svg class="w-6 h-6 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
            </svg>
        </button>
        <button id="heroNext" class="absolute right-6 top-1/2 transform -translate-y-1/2 glass-effect p-3 rounded-full hover:bg-white/20 transition-all">
            <svg class="w-6 h-6 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </button>
        
        <!-- Hero Indicators -->
        <div class="absolute bottom-8 left-1/2 transform -translate-x-1/2 flex space-x-3">
            <button class="hero-indicator w-3 h-3 bg-emerald-500 rounded-full transition-all" data-slide="0"></button>
            <button class="hero-indicator w-3 h-3 bg-white/30 rounded-full transition-all" data-slide="1"></button>
        </div>
    </section>

    <!-- Trending Now Section -->
    <section class="py-12">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="section-title text-3xl font-bold text-emerald-400">Tendencias Ahora</h2>
            </div>
            <div id="trendingCarousel" class="carousel-container flex space-x-6 overflow-x-auto pb-4">
                <!-- Trending content will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Continue Watching Section -->
    <section id="continueWatchingSection" class="py-12 hidden">
        <div class="container mx-auto px-6">
            <h2 class="section-title text-3xl font-bold mb-8 text-emerald-400">Continuar Viendo</h2>
            <div id="continueWatchingCarousel" class="carousel-container flex space-x-6 overflow-x-auto pb-4">
                <!-- Continue watching items will be loaded here -->
            </div>
        </div>
    </section>



    <!-- Popular Movies Section -->
    <section class="py-12">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="section-title text-3xl font-bold text-emerald-400">Películas Populares</h2>
            </div>
            <div id="moviesCarousel" class="carousel-container flex space-x-6 overflow-x-auto pb-4">
                <!-- Movies will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Best Anime Section -->
    <section class="py-12">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="section-title text-3xl font-bold text-emerald-400">Mejores Animes</h2>
            </div>
            <div id="animeCarousel" class="carousel-container flex space-x-6 overflow-x-auto pb-4">
                <!-- Anime will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Best TV Series Section -->
    <section class="py-12">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="section-title text-3xl font-bold text-emerald-400">Mejores Series</h2>
            </div>
            <div id="seriesCarousel" class="carousel-container flex space-x-6 overflow-x-auto pb-4">
                <!-- Series will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Best K-Drama Section -->
    <section class="py-12">
        <div class="container mx-auto px-6">
            <div class="flex items-center justify-between mb-8">
                <h2 class="section-title text-3xl font-bold text-emerald-400">Mejores K-Dramas</h2>
            </div>
            <div id="kdramaCarousel" class="carousel-container flex space-x-6 overflow-x-auto pb-4">
                <!-- K-Drama will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Footer Premium -->
    <footer class="glass-effect py-16 border-t border-emerald-500/20">
        <div class="container mx-auto px-6">
            <div class="grid md:grid-cols-4 gap-8">
                <div class="col-span-2">
                    <div class="text-3xl font-bold emerald-gradient bg-clip-text text-transparent mb-4">
                        KYB
                    </div>
                    <p class="text-gray-400 mb-6 leading-relaxed">
                        La plataforma de streaming definitiva. Disfruta de películas, series, animes y K-dramas en la más alta calidad, con funciones premium y experiencia personalizada.
                    </p>
                    <div class="flex space-x-4">
                        <!-- Instagram -->
                        <a href="#" class="glass-effect p-3 rounded-xl hover:bg-white/10 transition-all">
                            <svg class="w-6 h-6 text-emerald-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                        </a>
                        <!-- Facebook -->
                        <a href="#" class="glass-effect p-3 rounded-xl hover:bg-white/10 transition-all">
                            <svg class="w-6 h-6 text-emerald-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </a>
                        <!-- X (Twitter) -->
                        <a href="#" class="glass-effect p-3 rounded-xl hover:bg-white/10 transition-all">
                            <svg class="w-6 h-6 text-emerald-400" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-6 text-emerald-400">Contenido</h3>
                    <ul class="space-y-3 text-gray-400">
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Películas</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Series de TV</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Animes</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">K-Dramas</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Documentales</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-6 text-emerald-400">Soporte</h3>
                    <ul class="space-y-3 text-gray-400">
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Centro de Ayuda</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Términos de Uso</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Privacidad</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">Contacto</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition-colors">API</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-emerald-500/20 mt-12 pt-8 text-center">
                <p class="text-gray-400">
                    &copy; 2024 KYB Premium. Todos los derechos reservados. | 
                    <span class="text-emerald-400">Powered by Firebase & Advanced Streaming Technology</span>
                </p>
            </div>
        </div>
    </footer>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 login-modal z-50 hidden flex items-center justify-center p-4">
        <div class="modal-content rounded-2xl p-8 w-full max-w-md">
            <div class="text-center mb-8">
                <div class="text-2xl font-bold emerald-gradient bg-clip-text text-transparent mb-2">
                    Bienvenido a KYB
                </div>
                <p class="text-gray-400">Inicia sesión para acceder a contenido premium</p>
            </div>
            
            <div id="loginForm">
                <div class="space-y-4">
                    <div>
                        <input type="email" id="loginEmail" placeholder="Correo electrónico" 
                               class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-emerald-500/30 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20">
                    </div>
                    <div>
                        <input type="password" id="loginPassword" placeholder="Contraseña" 
                               class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-emerald-500/30 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20">
                    </div>
                    <button id="loginSubmit" class="w-full emerald-gradient emerald-gradient-hover py-3 rounded-xl font-semibold transition-all">
                        Iniciar Sesión
                    </button>
                </div>
                
                <div class="text-center mt-6">
                    <button id="showRegister" class="text-emerald-400 hover:text-emerald-300 transition-colors">
                        ¿No tienes cuenta? Regístrate
                    </button>
                </div>
            </div>
            
            <div id="registerForm" class="hidden">
                <div class="space-y-4">
                    <div>
                        <input type="text" id="registerName" placeholder="Nombre completo" 
                               class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-emerald-500/30 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20">
                    </div>
                    <div>
                        <input type="email" id="registerEmail" placeholder="Correo electrónico" 
                               class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-emerald-500/30 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20">
                    </div>
                    <div>
                        <input type="password" id="registerPassword" placeholder="Contraseña" 
                               class="w-full bg-gray-800/50 text-white px-4 py-3 rounded-xl border border-emerald-500/30 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20">
                    </div>
                    <button id="registerSubmit" class="w-full emerald-gradient emerald-gradient-hover py-3 rounded-xl font-semibold transition-all">
                        Crear Cuenta
                    </button>
                </div>
                
                <div class="text-center mt-6">
                    <button id="showLogin" class="text-emerald-400 hover:text-emerald-300 transition-colors">
                        ¿Ya tienes cuenta? Inicia sesión
                    </button>
                </div>
            </div>
            
            <button id="closeModal" class="absolute top-4 right-4 text-gray-400 hover:text-white transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification glass-effect rounded-xl p-4 border border-emerald-500/30">
        <div class="flex items-center space-x-3">
            <div class="w-10 h-10 emerald-gradient rounded-full flex items-center justify-center">
                <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
            </div>
            <div>
                <div class="font-semibold text-white">¡Bienvenido!</div>
                <div class="text-sm text-gray-400">Has iniciado sesión correctamente</div>
            </div>
        </div>
    </div>

    <!-- Floating Action Button -->
    <div class="floating-action">
        <button id="myListBtn" class="emerald-gradient p-4 rounded-full shadow-2xl hover:shadow-emerald-500/25 transition-all transform hover:scale-110">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
            </svg>
        </button>
    </div>

    <script>
        // Firebase Configuration - KYB Streaming
        const firebaseConfig = {
            apiKey: "AIzaSyAjXXFxC2S023gE10AciYYnHXaUX3Bqk8Q",
            authDomain: "kyb-streaming.firebaseapp.com",
            projectId: "kyb-streaming",
            storageBucket: "kyb-streaming.firebasestorage.app",
            messagingSenderId: "477209988490",
            appId: "1:477209988490:web:d7ad5d1cf166c131394c73",
            measurementId: "G-3JZ4ECYW0E"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Global variables
        let currentUser = null;
        let userWatchHistory = [];
        let userMyList = [];

        // Sample data for demonstration
        const sampleMovies = [
            { id: 1, title: "Acción Extrema", genre: "Acción", year: "2024", rating: 8.5, image: "blue-600", progress: 0 },
            { id: 2, title: "Drama Intenso", genre: "Drama", year: "2024", rating: 9.2, image: "red-600", progress: 0 },
            { id: 3, title: "Comedia Loca", genre: "Comedia", year: "2024", rating: 7.8, image: "green-600", progress: 0 },
            { id: 4, title: "Romance Épico", genre: "Romance", year: "2024", rating: 8.9, image: "purple-600", progress: 0 },
            { id: 5, title: "Thriller Oscuro", genre: "Thriller", year: "2024", rating: 8.3, image: "yellow-600", progress: 0 },
            { id: 6, title: "Sci-Fi Futurista", genre: "Sci-Fi", year: "2024", rating: 9.0, image: "indigo-600", progress: 0 }
        ];

        const sampleAnime = [
            { id: 7, title: "Ninja Legends", genre: "Shonen", year: "2024", rating: 9.5, image: "orange-600", progress: 0 },
            { id: 8, title: "Magic Academy", genre: "Fantasy", year: "2024", rating: 8.7, image: "pink-600", progress: 0 },
            { id: 9, title: "Mecha Warriors", genre: "Mecha", year: "2024", rating: 8.9, image: "blue-600", progress: 0 },
            { id: 10, title: "Slice of Life", genre: "Slice of Life", year: "2024", rating: 8.2, image: "green-600", progress: 0 },
            { id: 11, title: "Dark Fantasy", genre: "Dark Fantasy", year: "2024", rating: 9.1, image: "purple-600", progress: 0 },
            { id: 12, title: "Romance Anime", genre: "Romance", year: "2024", rating: 8.6, image: "red-600", progress: 0 }
        ];

        const sampleSeries = [
            { id: 13, title: "Crime Detective", genre: "Crime", year: "2024", rating: 8.8, image: "gray-600", progress: 0 },
            { id: 14, title: "Medical Drama", genre: "Drama", year: "2024", rating: 9.0, image: "teal-600", progress: 0 },
            { id: 15, title: "Historical Epic", genre: "Historical", year: "2024", rating: 8.5, image: "amber-600", progress: 0 },
            { id: 16, title: "Supernatural", genre: "Supernatural", year: "2024", rating: 8.7, image: "violet-600", progress: 0 },
            { id: 17, title: "Comedy Series", genre: "Comedy", year: "2024", rating: 8.1, image: "emerald-600", progress: 0 },
            { id: 18, title: "Political Thriller", genre: "Thriller", year: "2024", rating: 8.9, image: "rose-600", progress: 0 }
        ];

        const sampleKdrama = [
            { id: 19, title: "Romance Eterno", genre: "Romance", year: "2024", rating: 9.3, image: "pink-500", progress: 0 },
            { id: 20, title: "Business Empire", genre: "Business", year: "2024", rating: 8.6, image: "blue-500", progress: 0 },
            { id: 21, title: "Historical Love", genre: "Historical", year: "2024", rating: 8.8, image: "green-500", progress: 0 },
            { id: 22, title: "Fantasy Romance", genre: "Fantasy", year: "2024", rating: 9.0, image: "purple-500", progress: 0 },
            { id: 23, title: "School Drama", genre: "School", year: "2024", rating: 8.4, image: "orange-500", progress: 0 },
            { id: 24, title: "Medical Romance", genre: "Medical", year: "2024", rating: 8.7, image: "teal-500", progress: 0 }
        ];

        // Create content card
        function createContentCard(item, showProgress = false) {
            const progressBar = showProgress && item.progress > 0 ? 
                `<div class="progress-bar" style="width: ${item.progress}%"></div>` : '';
            
            return `
                <div class="poster-card flex-none w-56 bg-gray-800/50 rounded-2xl overflow-hidden cursor-pointer border border-gray-700/50 hover:border-emerald-500/50 transition-all" data-id="${item.id}">
                    <div class="relative">
                        <div class="h-80 bg-gradient-to-br from-${item.image} to-gray-800 flex items-center justify-center relative">
                            <span class="text-white font-bold text-center px-4 text-lg">${item.title}</span>
                            ${progressBar}
                            <div class="absolute top-3 right-3 glass-effect px-2 py-1 rounded-lg">
                                <div class="flex items-center space-x-1">
                                    <span class="rating-stars text-yellow-400 text-sm">★</span>
                                    <span class="text-white text-sm font-medium">${item.rating}</span>
                                </div>
                            </div>
                            <button class="add-to-list absolute top-3 left-3 glass-effect p-2 rounded-lg opacity-0 hover:opacity-100 transition-all" data-id="${item.id}">
                                <svg class="w-4 h-4 text-emerald-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-white text-lg mb-1">${item.title}</h3>
                        <div class="flex items-center justify-between">
                            <p class="text-emerald-400 text-sm">${item.year} • ${item.genre}</p>
                            <div class="flex items-center space-x-1">
                                <span class="rating-stars text-yellow-400 text-xs">★★★★★</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Create horizontal continue watching card
        function createContinueWatchingCard(item) {
            const progressBar = item.progress > 0 ? 
                `<div class="progress-bar" style="width: ${item.progress}%"></div>` : '';
            
            return `
                <div class="continue-watching-card flex-none w-80 bg-gray-800/50 rounded-2xl overflow-hidden cursor-pointer border border-gray-700/50 hover:border-emerald-500/50 transition-all" data-id="${item.id}">
                    <div class="flex">
                        <div class="relative w-32 h-20">
                            <div class="w-full h-full bg-gradient-to-br from-${item.image} to-gray-800 flex items-center justify-center relative">
                                <span class="text-white font-bold text-center px-2 text-xs">${item.title}</span>
                                ${progressBar}
                            </div>
                        </div>
                        <div class="flex-1 p-4">
                            <h3 class="font-semibold text-white text-sm mb-1">${item.title}</h3>
                            <p class="text-emerald-400 text-xs mb-2">${item.year} • ${item.genre}</p>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-1">
                                    <span class="rating-stars text-yellow-400 text-xs">★</span>
                                    <span class="text-white text-xs">${item.rating}</span>
                                </div>
                                <span class="text-emerald-300 text-xs">${item.progress}% visto</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Load content into carousels
        function loadContent() {
            // Load trending (mix of all content)
            const trending = [...sampleMovies.slice(0, 3), ...sampleAnime.slice(0, 2), ...sampleKdrama.slice(0, 1)];
            document.getElementById('trendingCarousel').innerHTML = trending.map(item => createContentCard(item)).join('');

            // Load individual sections
            document.getElementById('moviesCarousel').innerHTML = sampleMovies.map(item => createContentCard(item)).join('');
            document.getElementById('animeCarousel').innerHTML = sampleAnime.map(item => createContentCard(item)).join('');
            document.getElementById('seriesCarousel').innerHTML = sampleSeries.map(item => createContentCard(item)).join('');
            document.getElementById('kdramaCarousel').innerHTML = sampleKdrama.map(item => createContentCard(item)).join('');
        }

        // Hero button functions
        function playContent(contentId) {
            if (!currentUser) {
                showNotification('Inicia sesión', 'Debes iniciar sesión para ver contenido', 'error');
                return;
            }
            showNotification('Reproduciendo', `Iniciando ${contentId.replace('-', ' ')}...`);
            // Here you would implement actual video playback
        }

        function addToMyListFromHero(contentId) {
            if (!currentUser) {
                showNotification('Inicia sesión', 'Debes iniciar sesión para agregar a tu lista', 'error');
                return;
            }
            
            const heroContent = {
                'guardians-tomorrow': { id: 999, title: "Guardians of Tomorrow", genre: "Acción", year: "2024", rating: 9.2, image: "emerald-600", progress: 0 },
                'dragon-legends': { id: 998, title: "Dragon Legends", genre: "Anime", year: "2024", rating: 9.8, image: "red-600", progress: 0 }
            };
            
            const item = heroContent[contentId];
            if (item && !userMyList.find(listItem => listItem.id === item.id)) {
                userMyList.push(item);
                showNotification('¡Agregado!', `${item.title} se agregó a tu lista`);
                
                // Save to Firebase
                if (currentUser) {
                    db.collection('users').doc(currentUser.uid).update({
                        myList: userMyList
                    }).catch(error => console.error('Error saving to My List:', error));
                }
            } else {
                showNotification('Ya en tu lista', 'Este contenido ya está en tu lista');
            }
        }

        function showMoreInfo(contentId) {
            showNotification('Más información', `Mostrando detalles de ${contentId.replace('-', ' ')}...`);
            // Here you would show a modal with more details
        }

        // Hero banner functionality
        let currentHeroSlide = 0;
        const heroSlides = document.querySelectorAll('.banner-slide');
        const heroIndicators = document.querySelectorAll('.hero-indicator');
        const heroBanner = document.getElementById('heroBanner');

        function updateHeroBanner() {
            heroBanner.style.transform = `translateX(-${currentHeroSlide * 100}%)`;
            heroIndicators.forEach((indicator, index) => {
                if (index === currentHeroSlide) {
                    indicator.classList.remove('bg-white/30');
                    indicator.classList.add('bg-emerald-500');
                } else {
                    indicator.classList.remove('bg-emerald-500');
                    indicator.classList.add('bg-white/30');
                }
            });
        }

        function nextHeroSlide() {
            currentHeroSlide = (currentHeroSlide + 1) % heroSlides.length;
            updateHeroBanner();
        }

        function prevHeroSlide() {
            currentHeroSlide = (currentHeroSlide - 1 + heroSlides.length) % heroSlides.length;
            updateHeroBanner();
        }

        // Auto-rotate hero banner
        setInterval(nextHeroSlide, 6000);

        // Hero navigation
        document.getElementById('heroNext').addEventListener('click', nextHeroSlide);
        document.getElementById('heroPrev').addEventListener('click', prevHeroSlide);

        // Hero indicators
        heroIndicators.forEach((indicator, index) => {
            indicator.addEventListener('click', () => {
                currentHeroSlide = index;
                updateHeroBanner();
            });
        });

        // Search functionality
        document.getElementById('searchBtn').addEventListener('click', function() {
            // Redirect to search page
            window.location.href = 'search.html';
        });

        // Modal functionality
        const loginModal = document.getElementById('loginModal');
        const loginBtn = document.getElementById('loginBtn');
        const closeModal = document.getElementById('closeModal');
        const showRegister = document.getElementById('showRegister');
        const showLogin = document.getElementById('showLogin');
        const loginForm = document.getElementById('loginForm');
        const registerForm = document.getElementById('registerForm');

        loginBtn.addEventListener('click', () => {
            loginModal.classList.remove('hidden');
        });

        closeModal.addEventListener('click', () => {
            loginModal.classList.add('hidden');
        });

        showRegister.addEventListener('click', () => {
            loginForm.classList.add('hidden');
            registerForm.classList.remove('hidden');
        });

        showLogin.addEventListener('click', () => {
            registerForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
        });

        // Notification system
        function showNotification(title, message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.querySelector('.font-semibold').textContent = title;
            notification.querySelector('.text-sm').textContent = message;
            
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Real Firebase Authentication - Login
        document.getElementById('loginSubmit').addEventListener('click', async () => {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (email && password) {
                try {
                    const userCredential = await auth.signInWithEmailAndPassword(email, password);
                    currentUser = userCredential.user;
                    
                    updateUserInterface();
                    loginModal.classList.add('hidden');
                    showNotification('¡Bienvenido!', 'Has iniciado sesión correctamente');
                    loadUserData();
                } catch (error) {
                    console.error('Error al iniciar sesión:', error);
                    showNotification('Error', 'Credenciales incorrectas', 'error');
                }
            }
        });

        // Real Firebase Authentication - Register
        document.getElementById('registerSubmit').addEventListener('click', async () => {
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (name && email && password) {
                try {
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    currentUser = userCredential.user;
                    
                    // Update user profile with display name
                    await currentUser.updateProfile({
                        displayName: name
                    });
                    
                    // Create user document in Firestore
                    await db.collection('users').doc(currentUser.uid).set({
                        displayName: name,
                        email: email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        myList: [],
                        watchHistory: []
                    });
                    
                    updateUserInterface();
                    loginModal.classList.add('hidden');
                    showNotification('¡Cuenta creada!', 'Tu cuenta ha sido creada exitosamente');
                    loadUserData();
                } catch (error) {
                    console.error('Error al crear cuenta:', error);
                    showNotification('Error', 'No se pudo crear la cuenta', 'error');
                }
            }
        });

        // Update UI based on login status
        function updateUserInterface() {
            const loginBtn = document.getElementById('loginBtn');
            const userProfile = document.getElementById('userProfile');
            const userName = document.getElementById('userName');
            const continueWatchingSection = document.getElementById('continueWatchingSection');
            
            if (currentUser) {
                loginBtn.classList.add('hidden');
                userProfile.classList.remove('hidden');
                userName.textContent = currentUser.displayName || 'Usuario';
                continueWatchingSection.classList.remove('hidden');
            } else {
                loginBtn.classList.remove('hidden');
                userProfile.classList.add('hidden');
                continueWatchingSection.classList.add('hidden');
            }
        }

        // Firebase Auth State Listener
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                updateUserInterface();
                loadUserData();
            } else {
                currentUser = null;
                updateUserInterface();
                userWatchHistory = [];
                userMyList = [];
            }
        });

        // Load user data from Firebase (continue watching, my list)
        async function loadUserData() {
            if (!currentUser) return;
            
            try {
                const userDoc = await db.collection('users').doc(currentUser.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    userMyList = userData.myList || [];
                    userWatchHistory = userData.watchHistory || [];
                    
                    // Load continue watching data - only show if user has watch history
                    const continueWatchingSection = document.getElementById('continueWatchingSection');
                    const continueWatchingCarousel = document.getElementById('continueWatchingCarousel');
                    
                    if (userWatchHistory.length > 0) {
                        continueWatchingSection.classList.remove('hidden');
                        continueWatchingCarousel.innerHTML = userWatchHistory.map(item => createContinueWatchingCard(item)).join('');
                    } else {
                        continueWatchingSection.classList.add('hidden');
                    }
                }
            } catch (error) {
                console.error('Error loading user data:', error);
            }
        }

        // Add to My List functionality with Firebase
        async function addToMyList(itemId) {
            if (!currentUser) {
                showNotification('Inicia sesión', 'Debes iniciar sesión para agregar a tu lista', 'error');
                return;
            }
            
            // Find item in all arrays
            const allContent = [...sampleMovies, ...sampleAnime, ...sampleSeries, ...sampleKdrama];
            const item = allContent.find(content => content.id === parseInt(itemId));
            
            if (item && !userMyList.find(listItem => listItem.id === item.id)) {
                userMyList.push(item);
                showNotification('¡Agregado!', `${item.title} se agregó a tu lista`);
                
                // Save to Firebase
                try {
                    await db.collection('users').doc(currentUser.uid).update({
                        myList: userMyList
                    });
                } catch (error) {
                    console.error('Error saving to My List:', error);
                    showNotification('Error', 'No se pudo agregar a tu lista', 'error');
                }
            }
        }

        // Content click handlers
        document.addEventListener('click', async (e) => {
            if (e.target.closest('.poster-card') || e.target.closest('.continue-watching-card')) {
                const card = e.target.closest('.poster-card') || e.target.closest('.continue-watching-card');
                const itemId = card.dataset.id;
                
                if (e.target.closest('.add-to-list')) {
                    e.stopPropagation();
                    addToMyList(itemId);
                } else {
                    // Watch content and track progress
                    if (currentUser) {
                        const allContent = [...sampleMovies, ...sampleAnime, ...sampleSeries, ...sampleKdrama];
                        const item = allContent.find(content => content.id === parseInt(itemId));
                        if (item) {
                            showNotification('Reproduciendo', `Iniciando ${item.title}`);
                            
                            // Add to watch history with progress
                            const watchItem = { ...item, progress: Math.floor(Math.random() * 90) + 10, watchedAt: new Date() };
                            
                            // Update local array
                            const existingIndex = userWatchHistory.findIndex(historyItem => historyItem.id === item.id);
                            if (existingIndex >= 0) {
                                userWatchHistory[existingIndex] = watchItem;
                            } else {
                                userWatchHistory.unshift(watchItem);
                                if (userWatchHistory.length > 10) userWatchHistory.pop(); // Keep only 10 recent items
                            }
                            
                            // Save to Firebase
                            try {
                                await db.collection('users').doc(currentUser.uid).update({
                                    watchHistory: userWatchHistory
                                });
                                
                                // Reload continue watching section
                                loadUserData();
                            } catch (error) {
                                console.error('Error saving watch progress:', error);
                            }
                        }
                    } else {
                        showNotification('Inicia sesión', 'Debes iniciar sesión para ver contenido', 'error');
                    }
                }
            }
        });



        // Profile dropdown functionality
        document.getElementById('profileDropdown').addEventListener('click', () => {
            const profileMenu = document.getElementById('profileMenu');
            profileMenu.classList.toggle('hidden');
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            const profileDropdown = document.getElementById('profileDropdown');
            const profileMenu = document.getElementById('profileMenu');
            
            if (!profileDropdown.contains(e.target)) {
                profileMenu.classList.add('hidden');
            }
        });

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', async () => {
            try {
                await auth.signOut();
                showNotification('Sesión cerrada', 'Has cerrado sesión correctamente');
            } catch (error) {
                console.error('Error al cerrar sesión:', error);
                showNotification('Error', 'No se pudo cerrar la sesión', 'error');
            }
        });

        // My List floating button
        document.getElementById('myListBtn').addEventListener('click', () => {
            if (!currentUser) {
                showNotification('Inicia sesión', 'Debes iniciar sesión para ver tu lista', 'error');
                return;
            }
            
            if (userMyList.length === 0) {
                showNotification('Lista vacía', 'No tienes contenido en tu lista aún');
            } else {
                showNotification('Mi Lista', `Tienes ${userMyList.length} elementos en tu lista`);
                // Here you could open a modal or navigate to my list page
            }
        });

        // Initialize the application
        document.addEventListener('DOMContentLoaded', () => {
            loadContent();
            updateUserInterface();
            updateHeroBanner();
            
            // Show welcome message
            setTimeout(() => {
                showNotification('¡Bienvenido a KYB!');
            }, 1000);
        });

        // Firebase integration functions (to be implemented when config is provided)
        function saveToFirebase(collection, data) {
            // db.collection(collection).doc(currentUser.uid).set(data);
        }

        function loadFromFirebase(collection) {
            // return db.collection(collection).doc(currentUser.uid).get();
        }

        // Close modal when clicking outside
        loginModal.addEventListener('click', (e) => {
            if (e.target === loginModal) {
                loginModal.classList.add('hidden');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'969a3bb151871a4e',t:'MTc1NDI3MDQzNi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
